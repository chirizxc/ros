# ResNet

### 1. Объясните, как остаточные соединения (skip-connections) в ResNet решают проблему затухания градиента. Приведите формулу и поясните её смысл.
Остаточные соединения позволяют градиенту напрямую проходить через слои, минуя некоторые нелинейности. Это решает проблему затухания градиента в глубоких сетях.

**Формула:**  
y = F(x) + x  
где F(x) — это выход из сверточных слоев (остаточная функция), а x — вход.  
**Смысл:** если F(x) → 0, то y ≈ x, что помогает сохранить информацию и стабильность градиентов.

---

### 2. Почему в ResNet-50 используются Bottleneck-слои (1×1 → 3×3 → 1×1)? Какие задачи они решают в архитектуре?
Bottleneck-слои уменьшают количество параметров и вычислений, сохраняя глубину сети.  
- Первый 1×1 слой снижает размерность признаков.  
- 3×3 — извлекает пространственные признаки.  
- Последний 1×1 восстанавливает размерность.  
Это делает сеть глубокой и быстрой одновременно.

---

### 3. Чем отличается предобработка изображений для ResNet-50 от исходного размера изображений в CIFAR-10? Почему это важно?
- **CIFAR-10**: изображения 32×32, нормализация простая.  
- **ResNet-50 (ImageNet)**: ожидает 224×224 изображения и нормализацию с конкретными средними и std.  
**Важно:** ResNet-50 требует изменения размера и нормализации под ImageNet-формат.

---

### 4. Какие проблемы возникают при использовании модели, обученной на ImageNet (1000 классов), для классификации CIFAR-10 (10 классов)? Как в работе решалась эта проблема?
ResNet-50 обучена на 1000 классов ImageNet.  
**Проблемы:**
- Несоответствие классов.
- Перенос признаков может быть неточным.  
**Решение:** создать отображение классов и адаптировать выходы модели.

---

### 5. Как функция map_imagenet_to_cifar10 агрегирует классы ImageNet? Приведите примеры ключевых слов для двух классов CIFAR-10.
Функция сопоставляет группы классов ImageNet с 10 классами CIFAR-10.

**Примеры ключевых слов:**
- **"airplane"**: включает "airliner", "warplane", "jet".  
- **"dog"**: включает "Labrador", "Beagle", "Chihuahua".

---

### 6. Зачем в коде применяется денормализация изображений перед их визуализацией? Какие параметры нормализации использовались и почему?
Нормализованные изображения выглядят неестественно (сжатые значения).  
**Нормализация ImageNet:**
- Среднее: `[0.485, 0.456, 0.406]`
- Стд: `[0.229, 0.224, 0.225]`  
**Денормализация** возвращает изображения к исходному виду для визуализации.

---

### 7. Какие метрики используются для оценки качества модели в работе? Объясните, что показывает F1-score и в чём его преимущество перед accuracy.
- Accuracy
- Precision / Recall
- F1-score

**F1-score** — гармоническое среднее Precision и Recall.  
**Преимущество:** сбалансированная оценка при несбалансированных данных.

---

### 8. Почему при оценке модели на CIFAR-10 с помощью ResNet-50 могут возникать ошибки, связанные с различиями в доменах данных (ImageNet vs CIFAR-10)?
ImageNet и CIFAR-10 сильно отличаются по содержанию, разрешению, контексту.  
Это вызывает:
- Ошибки в распознавании.
- Переобучение на нерелевантные признаки.

---

### 9. Как матрица ошибок (confusion matrix) помогает анализировать слабые места модели? Приведите пример интерпретации.
Показывает, какие классы путает модель.

**Пример:** модель часто путает "cat" и "dog" → нужно улучшить признаки для этих классов.

---

### 10. Что произойдёт, если в функции imagenet_to_cifar10_prediction не учесть классы ImageNet, не соответствующие ни одному классу CIFAR-10? Как это повлияет на итоговые предсказания?
Такие классы могут быть случайно выбраны как предсказание.  
**Следствие:** снижение точности, некорректные метки.  
**Решение:** игнорировать или переназначить такие классы.